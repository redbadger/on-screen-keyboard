var onScreenKeyboard=function(){"use strict";var currentInputNode,Keyboard=function(keyRows){if(this.keyRows=keyRows,"undefined"==typeof this.keyRows||0===this.keyRows.length)throw new Error("The keyboard needs to have at least one key");this.setCurrentInputNode=function(e){currentInputNode=e.target,currentInputNode.addEventListener("key-pressed",function(e){e.target.value=e.detail})},this.inputNodes=document.querySelectorAll("input.on-screen-keyboard");for(var x=0;x<this.inputNodes.length;x++)this.inputNodes[x].addEventListener("focus",this.setCurrentInputNode,!0);this.keys=[]};Keyboard.prototype.remove=function(){for(var x=0;x<this.inputNodes.length;x++)this.inputNodes[x].removeEventListener("focus",this.setCurrentInputNode,!0);for(var y=0;y<this.keys.length;y++)this.keys[x]._remove()},Keyboard.prototype.buildRow=function(row){var DOMElement=document.createElement("div");return DOMElement.setAttribute("class","row"),row.forEach(function(key){key=new Key(key),DOMElement.appendChild(key.el),this.keys.push(key)}.bind(this)),DOMElement},Keyboard.prototype.render=function(){this.buffer=document.createDocumentFragment(),this.keyRows.forEach(function(row){row=this.buildRow(row),this.buffer.appendChild(row)}.bind(this));var keyboardUI=document.createElement("div");return keyboardUI.setAttribute("id","keyboard"),keyboardUI.appendChild(this.buffer),document.body.appendChild(keyboardUI),keyboardUI};var Key=function(key){if("string"!=typeof key&&"[object Object]"!==Object.prototype.toString.call(key))throw new Error("The key provided is not a string nor an object");this.key=key,this._onClick=this._onClick.bind(this),this.el=this.render()};return Key.prototype._remove=function(){this.el.removeEventListener("click",this._onClick)},Key.prototype._buildInputValue=function(){var newInputValue,currentInputValue=currentInputNode.value;if("object"==typeof this.key)switch(this.key.action){case"delete":newInputValue=currentInputValue.substr(0,currentInputValue.length-1)}else newInputValue=currentInputValue+this.key;return newInputValue},Key.prototype._onClick=function(){if(currentInputNode){var keyPressEvent=new CustomEvent("key-pressed",{detail:this._buildInputValue()});currentInputNode.dispatchEvent(keyPressEvent)}},Key.prototype.render=function(){var text=this.key,DOMElement=document.createElement("div");return"object"==typeof text&&(text=this.key.text),DOMElement.innerHTML=text,DOMElement.setAttribute("id","key-"+text),DOMElement.addEventListener("click",this._onClick),DOMElement},{Keyboard:Keyboard,Key:Key,_getCurrentInputNode:function(){return currentInputNode},_setCurrentInputNode:function(value){currentInputNode=value}}}();